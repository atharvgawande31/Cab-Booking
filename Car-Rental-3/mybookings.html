<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My Bookings</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body class="bg-gray-50">

  <!-- Header -->
  <section class="bg-blue-600 text-white py-12">
    <div class="max-w-5xl mx-auto px-4 text-center">
      <h1 class="text-4xl font-bold mb-2">My Bookings</h1>
      <p class="text-lg text-blue-100">Manage and track all your car rental bookings</p>
    </div>
  </section>

  <!-- Booking Tabs -->
  <div class="max-w-5xl mx-auto px-4 py-8">
    <div class="grid grid-cols-4 gap-2 mb-6">
      <button class="tab-btn bg-blue-600 text-white py-2 rounded" data-tab="all">All</button>
      <button class="tab-btn bg-white text-blue-600 border py-2 rounded" data-tab="confirmed">Confirmed</button>
      <button class="tab-btn bg-white text-blue-600 border py-2 rounded" data-tab="completed">Completed</button>
      <button class="tab-btn bg-white text-blue-600 border py-2 rounded" data-tab="cancelled">Cancelled</button>
    </div>

    <!-- Bookings Container -->
    <div id="bookings-container" class="space-y-6"></div>
  </div>

  <script>
    const bookings = [
      {
        id: "BK-001",
        status: "confirmed",
        car: { name: "BMW X5", category: "Luxury SUV", specs: { passengers: 5, fuel: "Petrol", transmission: "Automatic" }},
        rental: { pickupLocation: "Downtown LA", dropoffLocation: "LAX Airport", pickupDate: "2025-10-01", pickupTime: "10:00", dropoffDate: "2025-10-03", dropoffTime: "14:00", days: 3 },
        pricing: { total: 500.25 },
        bookingDate: "2025-09-28"
      },
      {
        id: "BK-002",
        status: "completed",
        car: { name: "Mercedes E-Class", category: "Executive", specs: { passengers: 5, fuel: "Hybrid", transmission: "Automatic" }},
        rental: { pickupLocation: "San Francisco Airport", dropoffLocation: "San Francisco Airport", pickupDate: "2025-09-20", pickupTime: "09:00", dropoffDate: "2025-09-25", dropoffTime: "15:00", days: 5 },
        pricing: { total: 475.00 },
        bookingDate: "2025-09-15"
      },
      {
        id: "BK-003",
        status: "cancelled",
        car: { name: "Audi A4", category: "Premium", specs: { passengers: 5, fuel: "Petrol", transmission: "Automatic" }},
        rental: { pickupLocation: "Miami Airport", dropoffLocation: "Miami Beach", pickupDate: "2025-09-10", pickupTime: "12:00", dropoffDate: "2025-09-12", dropoffTime: "16:00", days: 2 },
        pricing: { total: 150.00 },
        bookingDate: "2025-09-05"
      }
    ];

    const container = document.getElementById("bookings-container");
    const tabBtns = document.querySelectorAll(".tab-btn");

    function renderBookings(filter = "all") {
      container.innerHTML = "";
      const filtered = filter === "all" ? bookings : bookings.filter(b => b.status === filter);

      if (filtered.length === 0) {
        container.innerHTML = `<div class="bg-white shadow p-6 rounded text-center">
          <p class="text-gray-500">No ${filter} bookings found.</p>
          <a href="cars.html" class="mt-4 inline-block bg-blue-600 text-white px-4 py-2 rounded">Browse Cars</a>
        </div>`;
        return;
      }

      filtered.forEach(b => {
        container.innerHTML += `
          <div class="bg-white shadow p-6 rounded">
            <div class="flex justify-between items-center mb-4">
              <div>
                <h2 class="font-semibold">Booking #${b.id}</h2>
                <p class="text-sm text-gray-500">Booked on ${new Date(b.bookingDate).toLocaleDateString()}</p>
              </div>
              <div class="flex items-center gap-2">
                <span class="px-2 py-1 rounded text-xs ${b.status === "confirmed" ? "bg-green-100 text-green-700" : b.status === "completed" ? "bg-blue-100 text-blue-700" : "bg-red-100 text-red-700"}">${b.status}</span>
                <span class="font-bold text-blue-600">$${b.pricing.total}</span>
              </div>
            </div>

            <div class="grid md:grid-cols-3 gap-6 text-sm">
              <!-- Car Details -->
              <div>
                <h3 class="font-semibold mb-2">Vehicle</h3>
                <p>${b.car.name} - ${b.car.category}</p>
                <p class="text-gray-500">${b.car.specs.passengers} Passengers • ${b.car.specs.fuel} • ${b.car.specs.transmission}</p>
              </div>

              <!-- Rental Details -->
              <div>
                <h3 class="font-semibold mb-2">Rental Details</h3>
                <p><strong>Pickup:</strong> ${b.rental.pickupLocation}, ${b.rental.pickupDate} ${b.rental.pickupTime}</p>
                <p><strong>Dropoff:</strong> ${b.rental.dropoffLocation}, ${b.rental.dropoffDate} ${b.rental.dropoffTime}</p>
                <p><strong>Duration:</strong> ${b.rental.days} days</p>
              </div>

              <!-- Actions -->
              <div>
                <h3 class="font-semibold mb-2">Actions</h3>
                <button class="action-btn bg-blue-600 text-white px-3 py-1 rounded mb-2 w-full" onclick="downloadReceipt('${b.id}')">Download Receipt</button>
                ${b.status === "confirmed" ? `
                  <button class="action-btn bg-blue-600 text-white px-3 py-1 rounded mb-2 w-full" onclick="alert('Contacting Support for ${b.id}')">Contact Support</button>
                  <button class="action-btn bg-red-600 text-white px-3 py-1 rounded w-full" onclick="cancelBooking('${b.id}')">Cancel Booking</button>
                ` : b.status === "completed" ? `
                  <button class="action-btn bg-blue-600 text-white px-3 py-1 rounded w-full" onclick="alert('Leaving review for ${b.id}')">Leave Review</button>
                ` : ``}
              </div>
            </div>
          </div>
        `;
      });
    }

    function downloadReceipt(id) {
      const booking = bookings.find(b => b.id === id);
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      doc.text(`Booking Receipt - ${booking.id}`, 10, 10);
      doc.text(`Car: ${booking.car.name} (${booking.car.category})`, 10, 20);
      doc.text(`Pickup: ${booking.rental.pickupLocation} on ${booking.rental.pickupDate} ${booking.rental.pickupTime}`, 10, 30);
      doc.text(`Dropoff: ${booking.rental.dropoffLocation} on ${booking.rental.dropoffDate} ${booking.rental.dropoffTime}`, 10, 40);
      doc.text(`Total: $${booking.pricing.total}`, 10, 50);
      doc.save(`${booking.id}_receipt.pdf`);
    }

    function cancelBooking(id) {
      const booking = bookings.find(b => b.id === id);
      if (confirm(`Cancel booking ${id}?`)) {
        booking.status = "cancelled";
        renderBookings(document.querySelector(".tab-btn.bg-blue-600.text-white").dataset.tab);
      }
    }

    // Tab Switching
    tabBtns.forEach(btn => {
      btn.addEventListener("click", () => {
        tabBtns.forEach(b => b.classList.remove("bg-blue-600", "text-white"));
        tabBtns.forEach(b => b.classList.add("bg-white", "text-blue-600", "border"));
        btn.classList.add("bg-blue-600", "text-white");
        btn.classList.remove("bg-white", "text-blue-600", "border");
        renderBookings(btn.dataset.tab);
      });
    });

    // Initial load
    renderBookings("all");
  </script>
</body>
</html>